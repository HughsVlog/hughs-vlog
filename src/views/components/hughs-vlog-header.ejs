<% include ../head.xml %>
    <link rel="import" href="hughs-vlog-site-nav.html" />
  </head>
  <template id="hughs-vlog-header">
    <style>
      /*@namespace "http://www.w3.org/1999/xhtml";*/
      @namespace fb "http://www.facebook.com/2008/fbml";

      :host {
        display: block;
        text-align: center;
        margin-bottom: 3rem;
      }

      dl {
        height: 56px;
      }

      dd {
        margin-left: 0;
      }

      dt:first-of-type + dd::after {
        content: '';
        opacity: 0.25;
        display: inline-block;
        border-right: 1px solid black;
        margin-right: 1rem;
        padding-right: 1rem;
        width: 0;
        height: 100%;
      }

      dt {
        /* @todo: sr-only */
        display: none;
      }

      .subscribe-button-container {
        display: inline-block;
        /*vertical-align: middle;*/
        height: 100%;
      }

      .subscribe-button-container.subscribe-button-container--fb {
        width: 198px;
      }

      /*.subscribe-button-container.subscribe-button-container--yt {
        height: 48px;
      }*/

      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        overflow: hidden;
        clip: rect(0,0,0,0);
        white-space: nowrap;
        clip-path: inset(50%);
        border: 0;
      }

      /*fb\:like {
        @apply --fb-like;
      }*/

      /*fb|like {
        @apply --fb-like;
      }*/
    </style>
    <a href="/">
      <h1>Hughâ€™s Vlog</h1>
    </a>
    <p>The daily life of a startup founder, programmer, and filmmaker.</p>
    <hughs-vlog-site-nav></hughs-vlog-site-nav>
    <aside>
      <h2>Subscribe</h2>
      <dl>
        <dt class="sr-only">YouTube</dt>
        <dd class="subscribe-button-container subscribe-button-container--yt">
          <div id="yt-button-container-render">
            <div class="g-ytsubscribe"></div>
          </div>
        </dd>
        <dt class="sr-only">Facebook</dt>
        <dd class="subscribe-button-container subscribe-button-container--fb">
          <div id="fb-button-container-render">
            <!-- layout="button_count" -->
            <fb:like
              href="https://www.facebook.com/HughsVlog/"
              action="like"
              width="116"
              size="small"
              show-faces="true"
              share="false"></fb:like>
          </div>
        </dd>
        <!-- <dt>hugh.today</dt> -->
        <!-- <dd></dd> -->
      </dl>
    </aside>
  </template>
  <script>//<![CDATA[
  (function () {
    "use strict";

    // http://stackoverflow.com/q/41408477/214325
    var ownerDocument = document.currentScript.ownerDocument;

    class HughsVlogHeader extends HTMLElement {
      
      // Remember to call the super method here
      constructor() {
        super();

        const $shadowRoot = this.attachShadow({mode: 'open'});
        const $HughsVlogHeader = ownerDocument.querySelector( '#hughs-vlog-header' );
        const $shadowContent = $HughsVlogHeader.content.cloneNode( true );

        $shadowRoot.appendChild( $shadowContent );
      }

      connectedCallback() {
        // window.fbAsyncInit = this.renderFbLikeButton;

        this.setAttribute( 'role', 'banner' );
        this.youtubeChannelID = 'UCGPCcxdykgp6hgvL0XE3yaA';

        this.render();
      }

      renderFbLikeButton() {
        console.log( 'FB', FB );

        FB.XFBML.parse( ( this.shadowRoot || document ).getElementById( 'fb-button-container-render' ) );
      }

      // https://developers.google.com/youtube/subscribe/reference
      renderYtSubscribeButton( channelID ) {
        channelID = channelID || this.youtubeChannelID;

        var container = this.shadowRoot.getElementById( 'yt-button-container-render' );
        var options = {
          "channelId": channelID,
          // "layout": "default"
          "layout": "full"
        };
        gapi.ytsubscribe.render( container, options );
      }

      render() {
        this.renderYtSubscribeButton();
        // this.renderFbLikeButton();
      }
    }

    window.customElements.define( 'hughs-vlog-header', HughsVlogHeader );
  })();
  //]]></script>
</html>